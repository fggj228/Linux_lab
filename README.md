# Linux lern
---------------------------------------------------------------------------
___________________________________________________________________________
##lab_AAA

##попробуйте из под user3 выполнить sudo ls -l /root

##почему у вас не получилось?

user3 отсутствует в файле sudoers. Данное действие будет занесено в журнал

##добавьте запись о user3 и admins в /etc/sudoers 

![screenshot](Add_user3_and_admins_to_sudoers.png)

__________________________________________________________________________
--------------------------------------------------------------------------
__________________________________________________________________________
##lab_procces

##Какой размер дисков?

один диск на 931.5 гб

##Есть ли неразмеченное место на дисках?
Нет
    
##Какой размер партиций?

![screenshot](Size_disk.png)

##Какая таблица партционирования используется?
GPT

##Какой диск, партция или лвм том смонтированы в /

![screenshot](disk.png)




-----------------------------------------------------

##Создадим сжатую файловую систему для чтения squashfs
![screenshot](mai.sqsh.png)

##Какая файловая система примонтирована в /
![screenshot](smontirovano.png)

##С какими опциями примонтирована файловая система в /

/dev/sda4 on / type ext4 (rw,relatime,errors=remount-ro)

##Какой размер файловой системы приментированной в /mnt/mai

/dev/loop20      128K         128K     0          100% /mnt/mai

--------------------------------------------------------------
##Что такое tmpfs
tmpfs - временное файловое хранилище

##какая часть памяти изменялась?
![screenshot](size_izm.png)

---------------------------------------------------------------

##Какие процессы в системе порождают дочерние процессы через fork
gdm3
systemd
firefox

##Какие процессы в системе являются мультитредовыми
nfsd
firefox
jfsCommit

------------------------------------------------------------------
ps axo rss | tail -n +2|paste -sd+ | bc
##Что подсчитывается этой командой
Количество занятой оперативной памяти не в swap использованное в процессах вссех пользоателей

##Почему цифра такая странная
потому что она в килобайтах

------------------------------------------------------------------

##Уставновим утилиту smem и проанализируем параметр PSS в ней

![screenshot](smem.png)

-------------------------------------------------------------------
##Запустим приложеннный скрипт и понаблюдаем за процессами
python myfork.py

##в другом терминале  отследите порождение процессов
![screenshot](proc.png)

##отследите какие состояния вы видите у процессов
T and Z

##почему появляются процессы со статусам Z
это зомби процесс

##какой PID у основного процесса
26151 pts/2    00:00:00 python

##убейте основной процесс kill -9 <pid>
##какой PPID стал у первого чайлда
26153
##насколько вы разобрались в скрипте и втом что он делает?
в цикле делает fork()
    
------------------------------------------------------------------
##Научимся корректно завершать зомби процессы

##запустим еще раз наш процесc, убьем процесс первого чайлда u
##проверим его состояние  и убедимся что он зомби
![screenshot](zombie.png)

##расскоментируем строки в скрипте
##поторим все еще раз
##отследим корректное завершение чайлда
![screenshot](stop_zomb.png)

------------------------------------------------------------------
##Научимся убивать зомби процессы

##запускаем процессс еще раз
![screenshot](kill_with_gdb.png)

------------------------------------------------------------------
##Проблемы при отмонтировании директории
##Напишите какие процессы мешают размонтировать директорию
target is busy
user 18558 ..c.. bush
мешает bush, когда убиваем его процесс все работает

------------------------------------------------------------------
##Решаем загадку исчезновения места на диске
##проверим статус файла
![screenshot](status_test.png)

##проверим размер файловой системы и каталога
user@node-18:~/myfiles$ df 
/dev/sda4      637843200 32783344 572589432   6% /

user@node-18:~/myfiles$ du -sh  ~/myfiles
7,4G	/home/user/myfiles

##удалим файл
##повторно проверим размеры кталога и файловой системы

user@node-18:~/myfiles$ df 
/dev/sda4      637843200 58350616 547022160  10% /


user@node-18:~/myfiles$ du -sh  ~/myfiles
8,0K	/home/user/myfiles

После удаление файла процесс записи продолжается, файла в котолога больше нет, но место файловой системе уменьшилось
